<template>
    <header class="slds-media slds-media_center slds-has-flexi-truncate">
        <div class="slds-media__figure">
            <lightning-icon icon-name="standard:document_reference" alternative-text="PurchaseOrder" title="Purchase Order"></lightning-icon>
        </div>
        <template if:true={isSpinner}>
            <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
        </template>
        <div class="slds-media__body">
            <h2 class="slds-card__header-title">
                <span>입고 등록</span>
            </h2>
        </div>
        <div class="slds-no-flex">
            <lightning-button class="slds-button" name="search" variant="brand" label="저장" onclick={handleSaveRecord}></lightning-button>
        </div>
        <!-- <div class="slds-no-flex">
            <lightning-button name="retrieveErpAPProval" class="slds-button" variant="brand">Save</lightning-button>
        </div> -->
    </header>
    <!-- Body -->
    <div class="slds-box slds-theme_default slds-p-around_medium">
        <lightning-layout multiple-rows="true">
            <lightning-layout-item class="slds-var-p-right_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" name="name" label="입고 번호" disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" label="출고 번호" value={purchaseOrder.name} disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-right_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <c-gf-custom-lookup-cmp 
                    label="입고대리점"
                    name="partner"
                    object-name="Partner__c"
                    icon-name="standard:record_lookup"
                    order-by="Name"
                    enable-pre-search="true"
                    placeholder="선택해주세요."
                    data-index={index}
                    onchange={inputChangHandler}
                    required="true"
                    key-field="id">
                </c-gf-custom-lookup-cmp>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="Date" label="출고일자" value={purchaseOrder.purchaseDate} disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-right_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="Date" name="releaseDate" label="입고일자" onchange={inputChangHandler} value={orderInfo.releaseDate}></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" label="발주처" value={purchaseOrder.purchaseVendor} disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-right_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" label="입고금액" value={totalAmount} disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" label="출고금액" value={amount} disabled="true"></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="3" small-device-size="3" medium-device-size="3" large-device-size="3">
                <lightning-record-picker label="입고등록자"
                                        name="deliveryManager" 
                                        placeholder="Search..." 
                                        object-api-name="User"
                                        onchange={handleRecordPicker} 
                                        matching-info={recordPickerMatchingInfos.registorMatchingInfo} 
                                        display-info={reocrdPickerDisplayInfos.registorDisplayInfo}
                                        filter={recordPickerfilters.registorFilter}
                                        value={orderInfo.deliveryManager}
                                        >
                </lightning-record-picker>
            </lightning-layout-item>
            <lightning-layout-item class="slds-var-p-left_x-small" flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="6">
                <lightning-input type="text" label="입고연락처" value="" onchange={inputChangHandler}></lightning-input>
            </lightning-layout-item>
            <lightning-layout-item flexibility="auto" size="12" small-device-size="12" medium-device-size="12" large-device-size="12">
                <lightning-textarea name="description" label="비고" onchange={inputChangHandler}></lightning-textarea>
            </lightning-layout-item>
        </lightning-layout>

    </div>
    <section>
        <header class="slds-media slds-media_center slds-has-flexi-truncate">
            <div class="slds-media__figure">
                <lightning-icon icon-name="standard:document_reference" alternative-text="PurchaseOrder" title="Purchase Order"></lightning-icon>
            </div>
            <div class="slds-media__body">
                <h2 class="slds-card__header-title">
                    <span>출고 목록</span>
                </h2>
            </div>
            <div class="slds-no-flex">
                <lightning-button class="slds-button" name="" variant="brand" label="수량일치" onclick={handleQuantityMatch}></lightning-button>
            </div>
        </header>
        <div class="slds-box slds-theme_default slds-p-around_medium">
            <div class="customTableDiv">
                <!-- Table -->
                <!-- <table class="slds-max-medium-table_stacked slds-table slds-table_cell-buffer slds-table_bordered slds-table_col-bordered customTable"> -->
                <table class="slds-max-medium-table_stacked slds-table slds-table_bordered customTable">
                    <!-- thead -->
                    <thead class="slds-text-heading_small">
                        <tr class="slds-line-height_reset">
                            <!-- <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="checkbox"></div>
                            </th> -->
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="GoodsCode">품목코드</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="Name">품목명</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="NetPrice">단가</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head_mini_input" scope="col">
                                <div class="slds-truncate" title="QuantityOrder">발주수량</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="Quantity">출고수량</div>
                            </th>
                            <!-- <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="">출고금액</div>
                            </th> -->
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="">색깔</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="">직경</div>
                            </th>
                            <th class="slds-text-align_center custom_table_head" scope="col">
                                <div class="slds-truncate" title="">재질</div>
                            </th>
                        </tr>
                    </thead>
                    <!-- tbody -->
                    <tbody>
                        <template lwc:if={purchaseOrderItems} for:each={purchaseOrderItems} for:item="item" for:index="index">
                            <tr class="slds-hint-parent" key={item.index}>
                                <!-- <td data-label="Product Code" class="">
                                    <div class="slds-truncate" title="GoodsCode">
                                        <lightning-input name="isChecked" data-index={index} type="checkbox" checked={item.isChecked} variant="label-hidden" onclick={handleSelectedRow}></lightning-input>
                                    </div>
                                </td> -->
                                <td data-label="GoodsCode" class="slds-text-align_center">
                                    {item.goodsCode}
                                </td>
                                <td data-label="Name" class="slds-text-align_center">
                                    {item.name}
                                </td>
                                <td data-label="NetPrice" class="slds-text-align_center">
                                    <div class="slds-truncate" title="NetPrice">
                                        <lightning-input name="netPrice" data-index={index} variant="label-hidden" value={item.netPrice} type="number" onchange={inputChangHandler}></lightning-input>
                                    </div>
                                </td>
                                <td data-label="Quantity" class="slds-text-align_center">
                                    {item.quantity}
                                </td>
                                <td data-label="QuantityOrder" class="slds-text-align_center">
                                    <div class="slds-truncate" title="QuantityOrder">
                                        <lightning-input name="quantityOrder" data-index={index} variant="label-hidden" value={item.quantityOrder} type="number" onchange={inputChangHandler}></lightning-input>
                                    </div>
                                </td>
                                <!-- <td data-label="Product Code" class="slds-text-align_center">
                                    <div class="slds-truncate" title="">
                                        <lightning-input name="" variant="label-hidden" ></lightning-input>
                                    </div>
                                </td> -->
                                <td data-label="SkuOption1" class="slds-text-align_center">
                                    {item.skuOption1}
                                </td>
                                <td data-label="SkuOption2" class="slds-text-align_center">
                                    {item.skuOption2}
                                </td>
                                <td data-label="SkuOption3" class="slds-text-align_center">
                                    {item.skuOption3}
                                </td>
                            </tr>
                        </template>
                        <template lwc:else>
                            <tr class="customTableNoData" style="min-height: 10rem;">
                                <td data-label="Product Code" class="slds-text-align_center" colspan="9">
                                    No Data
                                </td>
                            </tr>
                        </template>

                    </tbody>
                </table>
            </div>
        </div>
    </section>  

</template>